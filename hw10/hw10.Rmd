---
title: "BACS HW10"
author: "Bijon Setyawan Raya"
date: "4/28/2021"
output: html_document
---

```{r, include=FALSE}
library(data.table)
library(dplyr)
library(lsa)
```


```{r}
# table <- fread("/users/bijonsetyawan/Documents/Git/bacs-hw/hw10/piccollage_accounts_bundles.csv") # macos
# table <- fread("/home/johnbjohn/Documents/git-repos/bacs-hw/hw10/piccollage_accounts_bundles.csv") # linux
matrix  <- as.matrix(table[, -1, with=FALSE])
```

### 1. Let’s make an automated recommendation system for the PicCollage mobile app.

#### A. Let’s explore to see if any sticker bundles seem intuitively similar:

**I. (recommended) Download PicCollage onto your mobile from the iOS/Android app store and a look at the style and content of various bundles in their Sticker Store: how many recommendations does each bundle have?**

Most bundles have 48 recommendations, except for PicCollage 101 which only has 5 recommendations.

**II. Find a single sticker bundle that is both in our limited data set and also in the app’s Sticker Store (e.g., “sweetmothersday”). Then, use your intuition to recommend (guess!) five other bundles in our dataset that might have similar usage patterns as this bundle.**

#### B. Let's find similar bundles using geometric models of similarity:

**I. Let’s create cosine similarity based recommendations for all bundles:**

1. Create a matrix or data.frame of the top 5 recommendations for all bundles

```{r}
cosine_similarity_matrix <- cosine(matrix)
diag(cosine_similarity_matrix) <- 100
recommendation_df <- data.frame(stringsAsFactors = F)
for(bundle in row.names(cosine_similarity_matrix)) {
  recommendation_df <- 
    rbind(
      recommendation_df, 
      names(
        cosine_similarity_matrix[
          bundle, 
          order(cosine_similarity_matrix[bundle, ], decreasing = T)
          ]
      )[1:6], 
      stringsAsFactors = F
    )
}
rownames(recommendation_df) <- row.names(cosine_similarity_matrix)
recommendation_df <- recommendation_df[, -1]
colnames(recommendation_df) <- c("First", "Second", "Third", "Fourth", "Fifth")

head(recommendation_df, 5)
```

2. Create a new function that automates the above functionality: it should take an accounts-bundles matrix as a parameter, and return a data object with the top 5 recommendations for each bundle in our data set.

```{r}
recommender <- function(matrix) {
  cosine_similarity_matrix <- cosine(matrix)
  recommendation_df <- data.frame(stringsAsFactors = FALSE)
  for(bundle in row.names(cosine_similarity_matrix)) {
    recommendation_df <- 
    rbind(
      recommendation_df, 
      names(
        cosine_similarity_matrix[
          bundle, 
          order(cosine_similarity_matrix[bundle, ], decreasing = T)
          ]
      )[1:6], 
      stringsAsFactors = F
    )
  }
  rownames(recommendation_df) <- row.names(cosine_similarity_matrix)
  recommendation <- recommendation_df[, -1]
  colnames(recommendation_df) <- 
    c("First", "Second", "Third", "Fourth", "Fifth")
  
  return(head(recommendation_df,5))
}

recommender(matrix)
```

**ii. Let’s create correlation based recommendations.**

1. Reuse the function you created above (do not change it; do not use the cor() function)

```{r}
means <- apply(matrix, 2, mean)
raw_matrix <- t(replicate(nrow(matrix), means))
mean_centered_matrix <- matrix - raw_matrix
```

2. But this time give the function an accounts-bundles matrix where each bundle (column) has already been mean-centered in advance.

```{r}
mean_centered_recommendation <- recommender(mean_centered_matrix)
head(mean_centered_recommendation, 4)
```

3. Now what are the top 5 recommendations for the bundle you chose to explore earlier?

**iii. Let’s create adjusted-cosine based recommendations.**

1. Reuse the function you created above (you should not have to change it)

2. But this time give the function an accounts-bundles matrix where each
account (row) has already been mean-centered in advance.

3. What are the top 5 recommendations for the bundle you chose to explore earlier?

### 2. Correlation is at the heart of many data analytic methods so let’s explore it further.